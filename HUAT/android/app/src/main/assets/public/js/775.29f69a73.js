"use strict";(self["webpackChunkHUAT"]=self["webpackChunkHUAT"]||[]).push([[775],{8775:(e,t,n)=>{n.r(t),n.d(t,{startInputShims:()=>A});var o=n(4074),r=n(6587);
/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */
const i=new WeakMap,s=(e,t,n,o=0,r=!1)=>{i.has(e)!==n&&(n?d(e,t,o,r):l(e,t))},a=e=>e===e.getRootNode().activeElement,d=(e,t,n,o=!1)=>{const r=t.parentNode,s=t.cloneNode(!1);s.classList.add("cloned-input"),s.tabIndex=-1,o&&(s.disabled=!0),r.appendChild(s),i.set(e,s);const a=e.ownerDocument,d="rtl"===a.dir?9999:-9999;e.style.pointerEvents="none",t.style.transform=`translate3d(${d}px,${n}px,0) scale(0)`},l=(e,t)=>{const n=i.get(e);n&&(i.delete(e),n.remove()),e.style.pointerEvents="",t.style.transform=""},c=(e,t,n)=>{if(!n||!t)return()=>{};const o=n=>{a(t)&&s(e,t,n)},i=()=>s(e,t,!1),d=()=>o(!0),l=()=>o(!1);return(0,r.a)(n,"ionScrollStart",d),(0,r.a)(n,"ionScrollEnd",l),t.addEventListener("blur",i),()=>{(0,r.b)(n,"ionScrollStart",d),(0,r.b)(n,"ionScrollEnd",l),t.addEventListener("ionBlur",i)}},u="input, textarea, [no-blur], [contenteditable]",m=()=>{let e=!0,t=!1;const n=document,o=()=>{t=!0},i=()=>{e=!0},s=o=>{if(t)return void(t=!1);const r=n.activeElement;if(!r)return;if(r.matches(u))return;const i=o.target;i!==r&&(i.matches(u)||i.closest(u)||(e=!1,setTimeout((()=>{e||r.blur()}),50)))};return(0,r.a)(n,"ionScrollStart",o),n.addEventListener("focusin",i,!0),n.addEventListener("touchend",s,!1),()=>{(0,r.b)(n,"ionScrollStart",o,!0),n.removeEventListener("focusin",i,!0),n.removeEventListener("touchend",s,!1)}},v=.3,f=(e,t,n)=>{var o;const r=null!==(o=e.closest("ion-item,[ion-item]"))&&void 0!==o?o:e;return p(r.getBoundingClientRect(),t.getBoundingClientRect(),n,e.ownerDocument.defaultView.innerHeight)},p=(e,t,n,o)=>{const r=e.top,i=e.bottom,s=t.top,a=Math.min(t.bottom,o-n),d=s+15,l=.75*a,c=l-i,u=d-r,m=Math.round(c<0?-c:u>0?-u:0),f=Math.min(m,r-s),p=Math.abs(f),h=p/v,w=Math.min(400,Math.max(150,h));return{scrollAmount:f,scrollDuration:w,scrollPadding:n,inputSafeY:4-(r-d)}},h=(e,t,n,o,i,s=!1)=>{let d;const l=e=>{d=(0,r.p)(e)},c=l=>{if(!d)return;const c=(0,r.p)(l);E(6,d,c)||a(t)||w(e,t,n,o,i,s)};return e.addEventListener("touchstart",l,{capture:!0,passive:!0}),e.addEventListener("touchend",c,!0),()=>{e.removeEventListener("touchstart",l,!0),e.removeEventListener("touchend",c,!0)}},w=async(e,t,n,i,a,d=!1)=>{if(!n&&!i)return;const l=f(e,n||i,a);if(n&&Math.abs(l.scrollAmount)<4)t.focus();else if(s(e,t,!0,l.inputSafeY,d),t.focus(),(0,r.r)((()=>e.click())),"undefined"!==typeof window){let r;const i=async()=>{void 0!==r&&clearTimeout(r),window.removeEventListener("ionKeyboardDidShow",a),window.removeEventListener("ionKeyboardDidShow",i),n&&await(0,o.c)(n,0,l.scrollAmount,l.scrollDuration),s(e,t,!1,l.inputSafeY),t.focus()},a=()=>{window.removeEventListener("ionKeyboardDidShow",a),window.addEventListener("ionKeyboardDidShow",i)};if(n){const e=await(0,o.g)(n),s=e.scrollHeight-e.clientHeight;if(l.scrollAmount>s-e.scrollTop)return"password"===t.type?(l.scrollAmount+=50,window.addEventListener("ionKeyboardDidShow",a)):window.addEventListener("ionKeyboardDidShow",i),void(r=setTimeout(i,1e3))}i()}},E=(e,t,n)=>{if(t&&n){const o=t.x-n.x,r=t.y-n.y,i=o*o+r*r;return i>e*e}return!1},y="$ionPaddingTimer",g=e=>{const t=document,n=t=>{b(t.target,e)},o=e=>{b(e.target,0)};return t.addEventListener("focusin",n),t.addEventListener("focusout",o),()=>{t.removeEventListener("focusin",n),t.removeEventListener("focusout",o)}},b=(e,t)=>{var n,r;if("INPUT"!==e.tagName)return;if(e.parentElement&&"ION-INPUT"===e.parentElement.tagName)return;if("ION-SEARCHBAR"===(null===(r=null===(n=e.parentElement)||void 0===n?void 0:n.parentElement)||void 0===r?void 0:r.tagName))return;const i=(0,o.a)(e);if(null===i)return;const s=i[y];s&&clearTimeout(s),t>0?i.style.setProperty("--keyboard-offset",`${t}px`):i[y]=setTimeout((()=>{i.style.setProperty("--keyboard-offset","0px")}),120)},S=!0,L=!0,A=(e,t)=>{const n=document,i="ios"===t,s="android"===t,a=e.getNumber("keyboardHeight",290),d=e.getBoolean("scrollAssist",!0),l=e.getBoolean("hideCaretOnScroll",i),u=e.getBoolean("inputBlurring",i),v=e.getBoolean("scrollPadding",!0),f=Array.from(n.querySelectorAll("ion-input, ion-textarea")),p=new WeakMap,w=new WeakMap,E=async e=>{await new Promise((t=>(0,r.c)(e,t)));const t=e.shadowRoot||e,n=t.querySelector("input")||t.querySelector("textarea"),i=(0,o.a)(e),u=i?null:e.closest("ion-footer");if(!n)return;if(i&&l&&!p.has(e)){const t=c(e,n,i);p.set(e,t)}const m="date"===n.type||"datetime-local"===n.type;if(!m&&(i||u)&&d&&!w.has(e)){const t=h(e,n,i,u,a,s);w.set(e,t)}},y=e=>{if(l){const t=p.get(e);t&&t(),p.delete(e)}if(d){const t=w.get(e);t&&t(),w.delete(e)}};u&&S&&m(),v&&L&&g(a);for(const o of f)E(o);n.addEventListener("ionInputDidLoad",(e=>{E(e.detail)})),n.addEventListener("ionInputDidUnload",(e=>{y(e.detail)}))}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxFQUFTaUMsR0FDM0R3SCxFQUFhckksSUFBSXJCLEVBQWFtSyxFQUNoQyxDQU9BLE1BQU1DLEVBQStCLFNBQWpCbkssRUFBUXlILE1BQW9DLG1CQUFqQnpILEVBQVF5SCxLQUN2RCxJQUFLMEMsSUFDQWxJLEdBQWM2RCxJQUNqQm9ELElBQ0NRLEVBQWdCdEosSUFBSUwsR0FBYyxDQUNuQyxNQUFNbUssRUFBT3JFLEVBQW1COUYsRUFBYUMsRUFBU2lDLEVBQVU2RCxFQUFVakMsRUFBZ0JtRixHQUMxRlUsRUFBZ0J0SSxJQUFJckIsRUFBYW1LLEVBQ25DLEdBRUlFLEVBQW1CckssSUFDdkIsR0FBSXNDLEVBQVcsQ0FDYixNQUFNZ0ksRUFBS1osRUFBYTVILElBQUk5QixHQUN4QnNLLEdBQ0ZBLElBRUZaLEVBQWEzSCxPQUFPL0IsRUFDdEIsQ0FDQSxHQUFJbUosRUFBYyxDQUNoQixNQUFNbUIsRUFBS1gsRUFBZ0I3SCxJQUFJOUIsR0FDM0JzSyxHQUNGQSxJQUVGWCxFQUFnQjVILE9BQU8vQixFQUN6QixHQUVFcUosR0FBaUJWLEdBQ25CaEcsSUFFRWlELEdBQWlCZ0QsR0FDbkJWLEVBQW9CcEUsR0FLdEIsSUFBSyxNQUFNckQsS0FBUzZJLEVBQ2xCTSxFQUFjbkosR0FHaEJhLEVBQUltQixpQkFBaUIsbUJBQXFCUyxJQUN4QzBHLEVBQWMxRyxFQUFHcUgsT0FDbEIsSUFDRGpKLEVBQUltQixpQkFBaUIscUJBQXVCUyxJQUMxQ21ILEVBQWdCbkgsRUFBR3FILE9BQ3BCLEdBQUUsQyIsInNvdXJjZXMiOlsid2VicGFjazovL0hVQVQvLi9ub2RlX21vZHVsZXMvQGlvbmljL2NvcmUvY29tcG9uZW50cy9pbnB1dC1zaGltcy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIChDKSBJb25pYyBodHRwOi8vaW9uaWNmcmFtZXdvcmsuY29tIC0gTUlUIExpY2Vuc2VcbiAqL1xuaW1wb3J0IHsgZyBhcyBnZXRTY3JvbGxFbGVtZW50LCBjIGFzIHNjcm9sbEJ5UG9pbnQsIGEgYXMgZmluZENsb3Nlc3RJb25Db250ZW50IH0gZnJvbSAnLi9pbmRleDkuanMnO1xuaW1wb3J0IHsgYSBhcyBhZGRFdmVudExpc3RlbmVyLCBiIGFzIHJlbW92ZUV2ZW50TGlzdGVuZXIsIHIgYXMgcmFmLCBwIGFzIHBvaW50ZXJDb29yZCwgYyBhcyBjb21wb25lbnRPblJlYWR5IH0gZnJvbSAnLi9oZWxwZXJzLmpzJztcblxuY29uc3QgY2xvbmVNYXAgPSBuZXcgV2Vha01hcCgpO1xuY29uc3QgcmVsb2NhdGVJbnB1dCA9IChjb21wb25lbnRFbCwgaW5wdXRFbCwgc2hvdWxkUmVsb2NhdGUsIGlucHV0UmVsYXRpdmVZID0gMCwgZGlzYWJsZWRDbG9uZWRJbnB1dCA9IGZhbHNlKSA9PiB7XG4gIGlmIChjbG9uZU1hcC5oYXMoY29tcG9uZW50RWwpID09PSBzaG91bGRSZWxvY2F0ZSkge1xuICAgIHJldHVybjtcbiAgfVxuICBpZiAoc2hvdWxkUmVsb2NhdGUpIHtcbiAgICBhZGRDbG9uZShjb21wb25lbnRFbCwgaW5wdXRFbCwgaW5wdXRSZWxhdGl2ZVksIGRpc2FibGVkQ2xvbmVkSW5wdXQpO1xuICB9XG4gIGVsc2Uge1xuICAgIHJlbW92ZUNsb25lKGNvbXBvbmVudEVsLCBpbnB1dEVsKTtcbiAgfVxufTtcbi8vIFRPRE8oRlctMjgzMik6IHR5cGVcbmNvbnN0IGlzRm9jdXNlZCA9IChpbnB1dCkgPT4ge1xuICByZXR1cm4gaW5wdXQgPT09IGlucHV0LmdldFJvb3ROb2RlKCkuYWN0aXZlRWxlbWVudDtcbn07XG5jb25zdCBhZGRDbG9uZSA9IChjb21wb25lbnRFbCwgaW5wdXRFbCwgaW5wdXRSZWxhdGl2ZVksIGRpc2FibGVkQ2xvbmVkSW5wdXQgPSBmYWxzZSkgPT4ge1xuICAvLyB0aGlzIGFsbG93cyBmb3IgdGhlIGFjdHVhbCBpbnB1dCB0byByZWNlaXZlIHRoZSBmb2N1cyBmcm9tXG4gIC8vIHRoZSB1c2VyJ3MgdG91Y2ggZXZlbnQsIGJ1dCBiZWZvcmUgaXQgcmVjZWl2ZXMgZm9jdXMsIGl0XG4gIC8vIG1vdmVzIHRoZSBhY3R1YWwgaW5wdXQgdG8gYSBsb2NhdGlvbiB0aGF0IHdpbGwgbm90IHNjcmV3XG4gIC8vIHVwIHRoZSBhcHAncyBsYXlvdXQsIGFuZCBkb2VzIG5vdCBhbGxvdyB0aGUgbmF0aXZlIGJyb3dzZXJcbiAgLy8gdG8gYXR0ZW1wdCB0byBzY3JvbGwgdGhlIGlucHV0IGludG8gcGxhY2UgKG1lc3NpbmcgdXAgaGVhZGVycy9mb290ZXJzKVxuICAvLyB0aGUgY2xvbmVkIGlucHV0IGZpbGxzIHRoZSBhcmVhIG9mIHdoZXJlIG5hdGl2ZSBpbnB1dCBzaG91bGQgYmVcbiAgLy8gd2hpbGUgdGhlIG5hdGl2ZSBpbnB1dCBmYWtlcyBvdXQgdGhlIGJyb3dzZXIgYnkgcmVsb2NhdGluZyBpdHNlbGZcbiAgLy8gYmVmb3JlIGl0IHJlY2VpdmVzIHRoZSBhY3R1YWwgZm9jdXMgZXZlbnRcbiAgLy8gV2UgaGlkZSB0aGUgZm9jdXNlZCBpbnB1dCAod2l0aCB0aGUgdmlzaWJsZSBjYXJldCkgaW52aXNpYmxlIGJ5IG1ha2luZyBpdCBzY2FsZSgwKSxcbiAgY29uc3QgcGFyZW50RWwgPSBpbnB1dEVsLnBhcmVudE5vZGU7XG4gIC8vIERPTSBXUklURVNcbiAgY29uc3QgY2xvbmVkRWwgPSBpbnB1dEVsLmNsb25lTm9kZShmYWxzZSk7XG4gIGNsb25lZEVsLmNsYXNzTGlzdC5hZGQoJ2Nsb25lZC1pbnB1dCcpO1xuICBjbG9uZWRFbC50YWJJbmRleCA9IC0xO1xuICAvKipcbiAgICogTWFraW5nIHRoZSBjbG9uZWQgaW5wdXQgZGlzYWJsZWQgcHJldmVudHNcbiAgICogQ2hyb21lIGZvciBBbmRyb2lkIGZyb20gc3RpbGwgc2Nyb2xsaW5nXG4gICAqIHRoZSBlbnRpcmUgcGFnZSBzaW5jZSB0aGlzIGNsb25lZCBpbnB1dFxuICAgKiB3aWxsIGJyaWVmbHkgYmUgaGlkZGVuIGJ5IHRoZSBrZXlib2FyZFxuICAgKiBldmVuIHRob3VnaCBpdCBpcyBub3QgZm9jdXNlZC5cbiAgICpcbiAgICogVGhpcyBpcyBub3QgbmVlZGVkIG9uIGlPUy4gV2hpbGUgdGhpc1xuICAgKiBkb2VzIG5vdCBjYXVzZSBmdW5jdGlvbmFsIGlzc3VlcyBvbiBpT1MsXG4gICAqIHRoZSBpbnB1dCBzdGlsbCBhcHBlYXJzIHNsaWdodGx5IGRpbW1lZCBldmVuXG4gICAqIGlmIHdlIHNldCBvcGFjaXR5OiAxLlxuICAgKi9cbiAgaWYgKGRpc2FibGVkQ2xvbmVkSW5wdXQpIHtcbiAgICBjbG9uZWRFbC5kaXNhYmxlZCA9IHRydWU7XG4gIH1cbiAgcGFyZW50RWwuYXBwZW5kQ2hpbGQoY2xvbmVkRWwpO1xuICBjbG9uZU1hcC5zZXQoY29tcG9uZW50RWwsIGNsb25lZEVsKTtcbiAgY29uc3QgZG9jID0gY29tcG9uZW50RWwub3duZXJEb2N1bWVudDtcbiAgY29uc3QgdHggPSBkb2MuZGlyID09PSAncnRsJyA/IDk5OTkgOiAtOTk5OTtcbiAgY29tcG9uZW50RWwuc3R5bGUucG9pbnRlckV2ZW50cyA9ICdub25lJztcbiAgaW5wdXRFbC5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlM2QoJHt0eH1weCwke2lucHV0UmVsYXRpdmVZfXB4LDApIHNjYWxlKDApYDtcbn07XG5jb25zdCByZW1vdmVDbG9uZSA9IChjb21wb25lbnRFbCwgaW5wdXRFbCkgPT4ge1xuICBjb25zdCBjbG9uZSA9IGNsb25lTWFwLmdldChjb21wb25lbnRFbCk7XG4gIGlmIChjbG9uZSkge1xuICAgIGNsb25lTWFwLmRlbGV0ZShjb21wb25lbnRFbCk7XG4gICAgY2xvbmUucmVtb3ZlKCk7XG4gIH1cbiAgY29tcG9uZW50RWwuc3R5bGUucG9pbnRlckV2ZW50cyA9ICcnO1xuICBpbnB1dEVsLnN0eWxlLnRyYW5zZm9ybSA9ICcnO1xufTtcblxuY29uc3QgZW5hYmxlSGlkZUNhcmV0T25TY3JvbGwgPSAoY29tcG9uZW50RWwsIGlucHV0RWwsIHNjcm9sbEVsKSA9PiB7XG4gIGlmICghc2Nyb2xsRWwgfHwgIWlucHV0RWwpIHtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgcmV0dXJuO1xuICAgIH07XG4gIH1cbiAgY29uc3Qgc2Nyb2xsSGlkZUNhcmV0ID0gKHNob3VsZEhpZGVDYXJldCkgPT4ge1xuICAgIGlmIChpc0ZvY3VzZWQoaW5wdXRFbCkpIHtcbiAgICAgIHJlbG9jYXRlSW5wdXQoY29tcG9uZW50RWwsIGlucHV0RWwsIHNob3VsZEhpZGVDYXJldCk7XG4gICAgfVxuICB9O1xuICBjb25zdCBvbkJsdXIgPSAoKSA9PiByZWxvY2F0ZUlucHV0KGNvbXBvbmVudEVsLCBpbnB1dEVsLCBmYWxzZSk7XG4gIGNvbnN0IGhpZGVDYXJldCA9ICgpID0+IHNjcm9sbEhpZGVDYXJldCh0cnVlKTtcbiAgY29uc3Qgc2hvd0NhcmV0ID0gKCkgPT4gc2Nyb2xsSGlkZUNhcmV0KGZhbHNlKTtcbiAgYWRkRXZlbnRMaXN0ZW5lcihzY3JvbGxFbCwgJ2lvblNjcm9sbFN0YXJ0JywgaGlkZUNhcmV0KTtcbiAgYWRkRXZlbnRMaXN0ZW5lcihzY3JvbGxFbCwgJ2lvblNjcm9sbEVuZCcsIHNob3dDYXJldCk7XG4gIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIG9uQmx1cik7XG4gIHJldHVybiAoKSA9PiB7XG4gICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcihzY3JvbGxFbCwgJ2lvblNjcm9sbFN0YXJ0JywgaGlkZUNhcmV0KTtcbiAgICByZW1vdmVFdmVudExpc3RlbmVyKHNjcm9sbEVsLCAnaW9uU2Nyb2xsRW5kJywgc2hvd0NhcmV0KTtcbiAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2lvbkJsdXInLCBvbkJsdXIpO1xuICB9O1xufTtcblxuY29uc3QgU0tJUF9TRUxFQ1RPUiA9ICdpbnB1dCwgdGV4dGFyZWEsIFtuby1ibHVyXSwgW2NvbnRlbnRlZGl0YWJsZV0nO1xuY29uc3QgZW5hYmxlSW5wdXRCbHVycmluZyA9ICgpID0+IHtcbiAgbGV0IGZvY3VzZWQgPSB0cnVlO1xuICBsZXQgZGlkU2Nyb2xsID0gZmFsc2U7XG4gIGNvbnN0IGRvYyA9IGRvY3VtZW50O1xuICBjb25zdCBvblNjcm9sbCA9ICgpID0+IHtcbiAgICBkaWRTY3JvbGwgPSB0cnVlO1xuICB9O1xuICBjb25zdCBvbkZvY3VzaW4gPSAoKSA9PiB7XG4gICAgZm9jdXNlZCA9IHRydWU7XG4gIH07XG4gIGNvbnN0IG9uVG91Y2hlbmQgPSAoZXYpID0+IHtcbiAgICAvLyBpZiBhcHAgZGlkIHNjcm9sbCByZXR1cm4gZWFybHlcbiAgICBpZiAoZGlkU2Nyb2xsKSB7XG4gICAgICBkaWRTY3JvbGwgPSBmYWxzZTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgYWN0aXZlID0gZG9jLmFjdGl2ZUVsZW1lbnQ7XG4gICAgaWYgKCFhY3RpdmUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLy8gb25seSBibHVyIGlmIHRoZSBhY3RpdmUgZWxlbWVudCBpcyBhIHRleHQtaW5wdXQgb3IgYSB0ZXh0YXJlYVxuICAgIGlmIChhY3RpdmUubWF0Y2hlcyhTS0lQX1NFTEVDVE9SKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAvLyBpZiB0aGUgc2VsZWN0ZWQgdGFyZ2V0IGlzIHRoZSBhY3RpdmUgZWxlbWVudCwgZG8gbm90IGJsdXJcbiAgICBjb25zdCB0YXBwZWQgPSBldi50YXJnZXQ7XG4gICAgaWYgKHRhcHBlZCA9PT0gYWN0aXZlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh0YXBwZWQubWF0Y2hlcyhTS0lQX1NFTEVDVE9SKSB8fCB0YXBwZWQuY2xvc2VzdChTS0lQX1NFTEVDVE9SKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBmb2N1c2VkID0gZmFsc2U7XG4gICAgLy8gVE9ETyBGVy0yNzk2OiBmaW5kIGEgYmV0dGVyIHdheSwgd2h5IDUwbXM/XG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBpZiAoIWZvY3VzZWQpIHtcbiAgICAgICAgYWN0aXZlLmJsdXIoKTtcbiAgICAgIH1cbiAgICB9LCA1MCk7XG4gIH07XG4gIGFkZEV2ZW50TGlzdGVuZXIoZG9jLCAnaW9uU2Nyb2xsU3RhcnQnLCBvblNjcm9sbCk7XG4gIGRvYy5hZGRFdmVudExpc3RlbmVyKCdmb2N1c2luJywgb25Gb2N1c2luLCB0cnVlKTtcbiAgZG9jLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgb25Ub3VjaGVuZCwgZmFsc2UpO1xuICByZXR1cm4gKCkgPT4ge1xuICAgIHJlbW92ZUV2ZW50TGlzdGVuZXIoZG9jLCAnaW9uU2Nyb2xsU3RhcnQnLCBvblNjcm9sbCwgdHJ1ZSk7XG4gICAgZG9jLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2ZvY3VzaW4nLCBvbkZvY3VzaW4sIHRydWUpO1xuICAgIGRvYy5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIG9uVG91Y2hlbmQsIGZhbHNlKTtcbiAgfTtcbn07XG5cbmNvbnN0IFNDUk9MTF9BU1NJU1RfU1BFRUQgPSAwLjM7XG5jb25zdCBnZXRTY3JvbGxEYXRhID0gKGNvbXBvbmVudEVsLCBjb250ZW50RWwsIGtleWJvYXJkSGVpZ2h0KSA9PiB7XG4gIHZhciBfYTtcbiAgY29uc3QgaXRlbUVsID0gKF9hID0gY29tcG9uZW50RWwuY2xvc2VzdCgnaW9uLWl0ZW0sW2lvbi1pdGVtXScpKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiBjb21wb25lbnRFbDtcbiAgcmV0dXJuIGNhbGNTY3JvbGxEYXRhKGl0ZW1FbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSwgY29udGVudEVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLCBrZXlib2FyZEhlaWdodCwgY29tcG9uZW50RWwub3duZXJEb2N1bWVudC5kZWZhdWx0Vmlldy5pbm5lckhlaWdodCAvLyBUT0RPKEZXLTI4MzIpOiB0eXBlXG4gICk7XG59O1xuY29uc3QgY2FsY1Njcm9sbERhdGEgPSAoaW5wdXRSZWN0LCBjb250ZW50UmVjdCwga2V5Ym9hcmRIZWlnaHQsIHBsYXRmb3JtSGVpZ2h0KSA9PiB7XG4gIC8vIGNvbXB1dGUgaW5wdXQncyBZIHZhbHVlcyByZWxhdGl2ZSB0byB0aGUgYm9keVxuICBjb25zdCBpbnB1dFRvcCA9IGlucHV0UmVjdC50b3A7XG4gIGNvbnN0IGlucHV0Qm90dG9tID0gaW5wdXRSZWN0LmJvdHRvbTtcbiAgLy8gY29tcHV0ZSB2aXNpYmxlIGFyZWFcbiAgY29uc3QgdmlzaWJsZUFyZWFUb3AgPSBjb250ZW50UmVjdC50b3A7XG4gIGNvbnN0IHZpc2libGVBcmVhQm90dG9tID0gTWF0aC5taW4oY29udGVudFJlY3QuYm90dG9tLCBwbGF0Zm9ybUhlaWdodCAtIGtleWJvYXJkSGVpZ2h0KTtcbiAgLy8gY29tcHV0ZSBzYWZlIGFyZWFcbiAgY29uc3Qgc2FmZUFyZWFUb3AgPSB2aXNpYmxlQXJlYVRvcCArIDE1O1xuICBjb25zdCBzYWZlQXJlYUJvdHRvbSA9IHZpc2libGVBcmVhQm90dG9tICogMC43NTtcbiAgLy8gZmlndXJlIG91dCBpZiBlYWNoIGVkZ2Ugb2YgdGhlIGlucHV0IGlzIHdpdGhpbiB0aGUgc2FmZSBhcmVhXG4gIGNvbnN0IGRpc3RhbmNlVG9Cb3R0b20gPSBzYWZlQXJlYUJvdHRvbSAtIGlucHV0Qm90dG9tO1xuICBjb25zdCBkaXN0YW5jZVRvVG9wID0gc2FmZUFyZWFUb3AgLSBpbnB1dFRvcDtcbiAgLy8gZGVzaXJlZFNjcm9sbEFtb3VudCBpcyB0aGUgbmVnYXRlZCBkaXN0YW5jZSB0byB0aGUgc2FmZSBhcmVhIGFjY29yZGluZyB0byBvdXIgY2FsY3VsYXRpb25zLlxuICBjb25zdCBkZXNpcmVkU2Nyb2xsQW1vdW50ID0gTWF0aC5yb3VuZChkaXN0YW5jZVRvQm90dG9tIDwgMCA/IC1kaXN0YW5jZVRvQm90dG9tIDogZGlzdGFuY2VUb1RvcCA+IDAgPyAtZGlzdGFuY2VUb1RvcCA6IDApO1xuICAvLyBvdXIgY2FsY3VsYXRpb25zIG1ha2Ugc29tZSBhc3N1bXB0aW9ucyB0aGF0IGFyZW4ndCBhbHdheXMgdHJ1ZSwgbGlrZSB0aGUga2V5Ym9hcmQgYmVpbmcgY2xvc2VkIHdoZW4gYW4gaW5wdXRcbiAgLy8gZ2V0cyBmb2N1cywgc28gbWFrZSBzdXJlIHdlIGRvbid0IHNjcm9sbCB0aGUgaW5wdXQgYWJvdmUgdGhlIHZpc2libGUgYXJlYVxuICBjb25zdCBzY3JvbGxBbW91bnQgPSBNYXRoLm1pbihkZXNpcmVkU2Nyb2xsQW1vdW50LCBpbnB1dFRvcCAtIHZpc2libGVBcmVhVG9wKTtcbiAgY29uc3QgZGlzdGFuY2UgPSBNYXRoLmFicyhzY3JvbGxBbW91bnQpO1xuICBjb25zdCBkdXJhdGlvbiA9IGRpc3RhbmNlIC8gU0NST0xMX0FTU0lTVF9TUEVFRDtcbiAgY29uc3Qgc2Nyb2xsRHVyYXRpb24gPSBNYXRoLm1pbig0MDAsIE1hdGgubWF4KDE1MCwgZHVyYXRpb24pKTtcbiAgcmV0dXJuIHtcbiAgICBzY3JvbGxBbW91bnQsXG4gICAgc2Nyb2xsRHVyYXRpb24sXG4gICAgc2Nyb2xsUGFkZGluZzoga2V5Ym9hcmRIZWlnaHQsXG4gICAgaW5wdXRTYWZlWTogLShpbnB1dFRvcCAtIHNhZmVBcmVhVG9wKSArIDQsXG4gIH07XG59O1xuXG5jb25zdCBlbmFibGVTY3JvbGxBc3Npc3QgPSAoY29tcG9uZW50RWwsIGlucHV0RWwsIGNvbnRlbnRFbCwgZm9vdGVyRWwsIGtleWJvYXJkSGVpZ2h0LCBkaXNhYmxlQ2xvbmVkSW5wdXQgPSBmYWxzZSkgPT4ge1xuICBsZXQgY29vcmQ7XG4gIGNvbnN0IHRvdWNoU3RhcnQgPSAoZXYpID0+IHtcbiAgICBjb29yZCA9IHBvaW50ZXJDb29yZChldik7XG4gIH07XG4gIGNvbnN0IHRvdWNoRW5kID0gKGV2KSA9PiB7XG4gICAgLy8gaW5wdXQgY292ZXIgdG91Y2hlbmQvbW91c2V1cFxuICAgIGlmICghY29vcmQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLy8gZ2V0IHdoZXJlIHRoZSB0b3VjaGVuZC9tb3VzZXVwIGVuZGVkXG4gICAgY29uc3QgZW5kQ29vcmQgPSBwb2ludGVyQ29vcmQoZXYpO1xuICAgIC8vIGZvY3VzIHRoaXMgaW5wdXQgaWYgdGhlIHBvaW50ZXIgaGFzbid0IG1vdmVkIFhYIHBpeGVsc1xuICAgIC8vIGFuZCB0aGUgaW5wdXQgZG9lc24ndCBhbHJlYWR5IGhhdmUgZm9jdXNcbiAgICBpZiAoIWhhc1BvaW50ZXJNb3ZlZCg2LCBjb29yZCwgZW5kQ29vcmQpICYmICFpc0ZvY3VzZWQoaW5wdXRFbCkpIHtcbiAgICAgIC8vIGJlZ2luIHRoZSBpbnB1dCBmb2N1cyBwcm9jZXNzXG4gICAgICBqc1NldEZvY3VzKGNvbXBvbmVudEVsLCBpbnB1dEVsLCBjb250ZW50RWwsIGZvb3RlckVsLCBrZXlib2FyZEhlaWdodCwgZGlzYWJsZUNsb25lZElucHV0KTtcbiAgICB9XG4gIH07XG4gIGNvbXBvbmVudEVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCB0b3VjaFN0YXJ0LCB7IGNhcHR1cmU6IHRydWUsIHBhc3NpdmU6IHRydWUgfSk7XG4gIGNvbXBvbmVudEVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgdG91Y2hFbmQsIHRydWUpO1xuICByZXR1cm4gKCkgPT4ge1xuICAgIGNvbXBvbmVudEVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCB0b3VjaFN0YXJ0LCB0cnVlKTtcbiAgICBjb21wb25lbnRFbC5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIHRvdWNoRW5kLCB0cnVlKTtcbiAgfTtcbn07XG5jb25zdCBqc1NldEZvY3VzID0gYXN5bmMgKGNvbXBvbmVudEVsLCBpbnB1dEVsLCBjb250ZW50RWwsIGZvb3RlckVsLCBrZXlib2FyZEhlaWdodCwgZGlzYWJsZUNsb25lZElucHV0ID0gZmFsc2UpID0+IHtcbiAgaWYgKCFjb250ZW50RWwgJiYgIWZvb3RlckVsKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IHNjcm9sbERhdGEgPSBnZXRTY3JvbGxEYXRhKGNvbXBvbmVudEVsLCAoY29udGVudEVsIHx8IGZvb3RlckVsKSwga2V5Ym9hcmRIZWlnaHQpO1xuICBpZiAoY29udGVudEVsICYmIE1hdGguYWJzKHNjcm9sbERhdGEuc2Nyb2xsQW1vdW50KSA8IDQpIHtcbiAgICAvLyB0aGUgdGV4dCBpbnB1dCBpcyBpbiBhIHNhZmUgcG9zaXRpb24gdGhhdCBkb2Vzbid0XG4gICAgLy8gcmVxdWlyZSBpdCB0byBiZSBzY3JvbGxlZCBpbnRvIHZpZXcsIGp1c3Qgc2V0IGZvY3VzIG5vd1xuICAgIGlucHV0RWwuZm9jdXMoKTtcbiAgICByZXR1cm47XG4gIH1cbiAgLy8gdGVtcG9yYXJpbHkgbW92ZSB0aGUgZm9jdXMgdG8gdGhlIGZvY3VzIGhvbGRlciBzbyB0aGUgYnJvd3NlclxuICAvLyBkb2Vzbid0IGZyZWFrIG91dCB3aGlsZSBpdCdzIHRyeWluZyB0byBnZXQgdGhlIGlucHV0IGluIHBsYWNlXG4gIC8vIGF0IHRoaXMgcG9pbnQgdGhlIG5hdGl2ZSB0ZXh0IGlucHV0IHN0aWxsIGRvZXMgbm90IGhhdmUgZm9jdXNcbiAgcmVsb2NhdGVJbnB1dChjb21wb25lbnRFbCwgaW5wdXRFbCwgdHJ1ZSwgc2Nyb2xsRGF0YS5pbnB1dFNhZmVZLCBkaXNhYmxlQ2xvbmVkSW5wdXQpO1xuICBpbnB1dEVsLmZvY3VzKCk7XG4gIC8qKlxuICAgKiBSZWxvY2F0aW5nL0ZvY3VzaW5nIGlucHV0IGNhdXNlcyB0aGVcbiAgICogY2xpY2sgZXZlbnQgdG8gYmUgY2FuY2VsbGVkLCBzb1xuICAgKiBtYW51YWxseSBmaXJlIG9uZSBoZXJlLlxuICAgKi9cbiAgcmFmKCgpID0+IGNvbXBvbmVudEVsLmNsaWNrKCkpO1xuICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBsZXQgc2Nyb2xsQ29udGVudFRpbWVvdXQ7XG4gICAgY29uc3Qgc2Nyb2xsQ29udGVudCA9IGFzeW5jICgpID0+IHtcbiAgICAgIC8vIGNsZWFuIHVwIGxpc3RlbmVycyBhbmQgdGltZW91dHNcbiAgICAgIGlmIChzY3JvbGxDb250ZW50VGltZW91dCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGNsZWFyVGltZW91dChzY3JvbGxDb250ZW50VGltZW91dCk7XG4gICAgICB9XG4gICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignaW9uS2V5Ym9hcmREaWRTaG93JywgZG91YmxlS2V5Ym9hcmRFdmVudExpc3RlbmVyKTtcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdpb25LZXlib2FyZERpZFNob3cnLCBzY3JvbGxDb250ZW50KTtcbiAgICAgIC8vIHNjcm9sbCB0aGUgaW5wdXQgaW50byBwbGFjZVxuICAgICAgaWYgKGNvbnRlbnRFbCkge1xuICAgICAgICBhd2FpdCBzY3JvbGxCeVBvaW50KGNvbnRlbnRFbCwgMCwgc2Nyb2xsRGF0YS5zY3JvbGxBbW91bnQsIHNjcm9sbERhdGEuc2Nyb2xsRHVyYXRpb24pO1xuICAgICAgfVxuICAgICAgLy8gdGhlIHNjcm9sbCB2aWV3IGlzIGluIHRoZSBjb3JyZWN0IHBvc2l0aW9uIG5vd1xuICAgICAgLy8gZ2l2ZSB0aGUgbmF0aXZlIHRleHQgaW5wdXQgZm9jdXNcbiAgICAgIHJlbG9jYXRlSW5wdXQoY29tcG9uZW50RWwsIGlucHV0RWwsIGZhbHNlLCBzY3JvbGxEYXRhLmlucHV0U2FmZVkpO1xuICAgICAgLy8gZW5zdXJlIHRoaXMgaXMgdGhlIGZvY3VzZWQgaW5wdXRcbiAgICAgIGlucHV0RWwuZm9jdXMoKTtcbiAgICB9O1xuICAgIGNvbnN0IGRvdWJsZUtleWJvYXJkRXZlbnRMaXN0ZW5lciA9ICgpID0+IHtcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdpb25LZXlib2FyZERpZFNob3cnLCBkb3VibGVLZXlib2FyZEV2ZW50TGlzdGVuZXIpO1xuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2lvbktleWJvYXJkRGlkU2hvdycsIHNjcm9sbENvbnRlbnQpO1xuICAgIH07XG4gICAgaWYgKGNvbnRlbnRFbCkge1xuICAgICAgY29uc3Qgc2Nyb2xsRWwgPSBhd2FpdCBnZXRTY3JvbGxFbGVtZW50KGNvbnRlbnRFbCk7XG4gICAgICAvKipcbiAgICAgICAqIHNjcm9sbERhdGEgd2lsbCBvbmx5IGNvbnNpZGVyIHRoZSBhbW91bnQgd2UgbmVlZFxuICAgICAgICogdG8gc2Nyb2xsIGluIG9yZGVyIHRvIHByb3Blcmx5IGJyaW5nIHRoZSBpbnB1dFxuICAgICAgICogaW50byB2aWV3LiBJdCB3aWxsIG5vdCBjb25zaWRlciB0aGUgYW1vdW50XG4gICAgICAgKiB3ZSBjYW4gc2Nyb2xsIGluIHRoZSBjb250ZW50IGVsZW1lbnQuXG4gICAgICAgKiBBcyBhIHJlc3VsdCwgc2Nyb2xsRGF0YSBtYXkgcmVxdWVzdCBhIGdyZWF0ZXJcbiAgICAgICAqIHNjcm9sbCBwb3NpdGlvbiB0aGFuIGlzIGN1cnJlbnRseSBhdmFpbGFibGVcbiAgICAgICAqIGluIHRoZSBET00uIElmIHRoaXMgaXMgdGhlIGNhc2UsIHdlIG5lZWQgdG9cbiAgICAgICAqIHdhaXQgZm9yIHRoZSB3ZWJ2aWV3IHRvIHJlc2l6ZS90aGUga2V5Ym9hcmRcbiAgICAgICAqIHRvIHNob3cgaW4gb3JkZXIgZm9yIGFkZGl0aW9uYWwgc2Nyb2xsXG4gICAgICAgKiBiYW5kd2lkdGggdG8gYmVjb21lIGF2YWlsYWJsZS5cbiAgICAgICAqL1xuICAgICAgY29uc3QgdG90YWxTY3JvbGxBbW91bnQgPSBzY3JvbGxFbC5zY3JvbGxIZWlnaHQgLSBzY3JvbGxFbC5jbGllbnRIZWlnaHQ7XG4gICAgICBpZiAoc2Nyb2xsRGF0YS5zY3JvbGxBbW91bnQgPiB0b3RhbFNjcm9sbEFtb3VudCAtIHNjcm9sbEVsLnNjcm9sbFRvcCkge1xuICAgICAgICAvKipcbiAgICAgICAgICogT24gaU9TIGRldmljZXMsIHRoZSBzeXN0ZW0gd2lsbCBzaG93IGEgXCJQYXNzd29yZHNcIiBiYXIgYWJvdmUgdGhlIGtleWJvYXJkXG4gICAgICAgICAqIGFmdGVyIHRoZSBpbml0aWFsIGtleWJvYXJkIGlzIHNob3duLiBUaGlzIHByZXZlbnRzIHRoZSB3ZWJ2aWV3IGZyb20gcmVzaXppbmdcbiAgICAgICAgICogdW50aWwgdGhlIFwiUGFzc3dvcmRzXCIgYmFyIGlzIHNob3duLCBzbyB3ZSBuZWVkIHRvIHdhaXQgZm9yIHRoYXQgdG8gaGFwcGVuIGZpcnN0LlxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKGlucHV0RWwudHlwZSA9PT0gJ3Bhc3N3b3JkJykge1xuICAgICAgICAgIC8vIEFkZCA1MHB4IHRvIGFjY291bnQgZm9yIHRoZSBcIlBhc3N3b3Jkc1wiIGJhclxuICAgICAgICAgIHNjcm9sbERhdGEuc2Nyb2xsQW1vdW50ICs9IDUwO1xuICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdpb25LZXlib2FyZERpZFNob3cnLCBkb3VibGVLZXlib2FyZEV2ZW50TGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdpb25LZXlib2FyZERpZFNob3cnLCBzY3JvbGxDb250ZW50KTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogVGhpcyBzaG91bGQgb25seSBmaXJlIGluIDIgaW5zdGFuY2VzOlxuICAgICAgICAgKiAxLiBUaGUgYXBwIGlzIHZlcnkgc2xvdy5cbiAgICAgICAgICogMi4gVGhlIGFwcCBpcyBydW5uaW5nIGluIGEgYnJvd3NlciBvbiBhbiBvbGQgT1NcbiAgICAgICAgICogdGhhdCBkb2VzIG5vdCBzdXBwb3J0IElvbmljIEtleWJvYXJkIEV2ZW50c1xuICAgICAgICAgKi9cbiAgICAgICAgc2Nyb2xsQ29udGVudFRpbWVvdXQgPSBzZXRUaW1lb3V0KHNjcm9sbENvbnRlbnQsIDEwMDApO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICAgIHNjcm9sbENvbnRlbnQoKTtcbiAgfVxufTtcbmNvbnN0IGhhc1BvaW50ZXJNb3ZlZCA9ICh0aHJlc2hvbGQsIHN0YXJ0Q29vcmQsIGVuZENvb3JkKSA9PiB7XG4gIGlmIChzdGFydENvb3JkICYmIGVuZENvb3JkKSB7XG4gICAgY29uc3QgZGVsdGFYID0gc3RhcnRDb29yZC54IC0gZW5kQ29vcmQueDtcbiAgICBjb25zdCBkZWx0YVkgPSBzdGFydENvb3JkLnkgLSBlbmRDb29yZC55O1xuICAgIGNvbnN0IGRpc3RhbmNlID0gZGVsdGFYICogZGVsdGFYICsgZGVsdGFZICogZGVsdGFZO1xuICAgIHJldHVybiBkaXN0YW5jZSA+IHRocmVzaG9sZCAqIHRocmVzaG9sZDtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59O1xuXG5jb25zdCBQQURESU5HX1RJTUVSX0tFWSA9ICckaW9uUGFkZGluZ1RpbWVyJztcbmNvbnN0IGVuYWJsZVNjcm9sbFBhZGRpbmcgPSAoa2V5Ym9hcmRIZWlnaHQpID0+IHtcbiAgY29uc3QgZG9jID0gZG9jdW1lbnQ7XG4gIC8vIFRPRE8oRlctMjgzMik6IHR5cGVzXG4gIGNvbnN0IG9uRm9jdXNpbiA9IChldikgPT4ge1xuICAgIHNldFNjcm9sbFBhZGRpbmcoZXYudGFyZ2V0LCBrZXlib2FyZEhlaWdodCk7XG4gIH07XG4gIGNvbnN0IG9uRm9jdXNvdXQgPSAoZXYpID0+IHtcbiAgICBzZXRTY3JvbGxQYWRkaW5nKGV2LnRhcmdldCwgMCk7XG4gIH07XG4gIGRvYy5hZGRFdmVudExpc3RlbmVyKCdmb2N1c2luJywgb25Gb2N1c2luKTtcbiAgZG9jLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3Vzb3V0Jywgb25Gb2N1c291dCk7XG4gIHJldHVybiAoKSA9PiB7XG4gICAgZG9jLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2ZvY3VzaW4nLCBvbkZvY3VzaW4pO1xuICAgIGRvYy5yZW1vdmVFdmVudExpc3RlbmVyKCdmb2N1c291dCcsIG9uRm9jdXNvdXQpO1xuICB9O1xufTtcbmNvbnN0IHNldFNjcm9sbFBhZGRpbmcgPSAoaW5wdXQsIGtleWJvYXJkSGVpZ2h0KSA9PiB7XG4gIHZhciBfYSwgX2I7XG4gIGlmIChpbnB1dC50YWdOYW1lICE9PSAnSU5QVVQnKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGlmIChpbnB1dC5wYXJlbnRFbGVtZW50ICYmIGlucHV0LnBhcmVudEVsZW1lbnQudGFnTmFtZSA9PT0gJ0lPTi1JTlBVVCcpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKCgoX2IgPSAoX2EgPSBpbnB1dC5wYXJlbnRFbGVtZW50KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EucGFyZW50RWxlbWVudCkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLnRhZ05hbWUpID09PSAnSU9OLVNFQVJDSEJBUicpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgZWwgPSBmaW5kQ2xvc2VzdElvbkNvbnRlbnQoaW5wdXQpO1xuICBpZiAoZWwgPT09IG51bGwpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgdGltZXIgPSBlbFtQQURESU5HX1RJTUVSX0tFWV07XG4gIGlmICh0aW1lcikge1xuICAgIGNsZWFyVGltZW91dCh0aW1lcik7XG4gIH1cbiAgaWYgKGtleWJvYXJkSGVpZ2h0ID4gMCkge1xuICAgIGVsLnN0eWxlLnNldFByb3BlcnR5KCctLWtleWJvYXJkLW9mZnNldCcsIGAke2tleWJvYXJkSGVpZ2h0fXB4YCk7XG4gIH1cbiAgZWxzZSB7XG4gICAgZWxbUEFERElOR19USU1FUl9LRVldID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBlbC5zdHlsZS5zZXRQcm9wZXJ0eSgnLS1rZXlib2FyZC1vZmZzZXQnLCAnMHB4Jyk7XG4gICAgfSwgMTIwKTtcbiAgfVxufTtcblxuY29uc3QgSU5QVVRfQkxVUlJJTkcgPSB0cnVlO1xuY29uc3QgU0NST0xMX1BBRERJTkcgPSB0cnVlO1xuY29uc3Qgc3RhcnRJbnB1dFNoaW1zID0gKGNvbmZpZywgcGxhdGZvcm0pID0+IHtcbiAgY29uc3QgZG9jID0gZG9jdW1lbnQ7XG4gIGNvbnN0IGlzSU9TID0gcGxhdGZvcm0gPT09ICdpb3MnO1xuICBjb25zdCBpc0FuZHJvaWQgPSBwbGF0Zm9ybSA9PT0gJ2FuZHJvaWQnO1xuICAvKipcbiAgICogSGlkZSBDYXJldCBhbmQgSW5wdXQgQmx1cnJpbmcgYXJlIG5lZWRlZCBvbiBpT1MuXG4gICAqIFNjcm9sbCBBc3Npc3QgYW5kIFNjcm9sbCBQYWRkaW5nIGFyZSBuZWVkZWQgb24gaU9TIGFuZCBBbmRyb2lkXG4gICAqIHdpdGggQ2hyb21lIHdlYiBicm93c2VyIChub3QgQ2hyb21lIHdlYnZpZXcpLlxuICAgKi9cbiAgY29uc3Qga2V5Ym9hcmRIZWlnaHQgPSBjb25maWcuZ2V0TnVtYmVyKCdrZXlib2FyZEhlaWdodCcsIDI5MCk7XG4gIGNvbnN0IHNjcm9sbEFzc2lzdCA9IGNvbmZpZy5nZXRCb29sZWFuKCdzY3JvbGxBc3Npc3QnLCB0cnVlKTtcbiAgY29uc3QgaGlkZUNhcmV0ID0gY29uZmlnLmdldEJvb2xlYW4oJ2hpZGVDYXJldE9uU2Nyb2xsJywgaXNJT1MpO1xuICBjb25zdCBpbnB1dEJsdXJyaW5nID0gY29uZmlnLmdldEJvb2xlYW4oJ2lucHV0Qmx1cnJpbmcnLCBpc0lPUyk7XG4gIGNvbnN0IHNjcm9sbFBhZGRpbmcgPSBjb25maWcuZ2V0Qm9vbGVhbignc2Nyb2xsUGFkZGluZycsIHRydWUpO1xuICBjb25zdCBpbnB1dHMgPSBBcnJheS5mcm9tKGRvYy5xdWVyeVNlbGVjdG9yQWxsKCdpb24taW5wdXQsIGlvbi10ZXh0YXJlYScpKTtcbiAgY29uc3QgaGlkZUNhcmV0TWFwID0gbmV3IFdlYWtNYXAoKTtcbiAgY29uc3Qgc2Nyb2xsQXNzaXN0TWFwID0gbmV3IFdlYWtNYXAoKTtcbiAgY29uc3QgcmVnaXN0ZXJJbnB1dCA9IGFzeW5jIChjb21wb25lbnRFbCkgPT4ge1xuICAgIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBjb21wb25lbnRPblJlYWR5KGNvbXBvbmVudEVsLCByZXNvbHZlKSk7XG4gICAgY29uc3QgaW5wdXRSb290ID0gY29tcG9uZW50RWwuc2hhZG93Um9vdCB8fCBjb21wb25lbnRFbDtcbiAgICBjb25zdCBpbnB1dEVsID0gaW5wdXRSb290LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0JykgfHwgaW5wdXRSb290LnF1ZXJ5U2VsZWN0b3IoJ3RleHRhcmVhJyk7XG4gICAgY29uc3Qgc2Nyb2xsRWwgPSBmaW5kQ2xvc2VzdElvbkNvbnRlbnQoY29tcG9uZW50RWwpO1xuICAgIGNvbnN0IGZvb3RlckVsID0gIXNjcm9sbEVsID8gY29tcG9uZW50RWwuY2xvc2VzdCgnaW9uLWZvb3RlcicpIDogbnVsbDtcbiAgICBpZiAoIWlucHV0RWwpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKCEhc2Nyb2xsRWwgJiYgaGlkZUNhcmV0ICYmICFoaWRlQ2FyZXRNYXAuaGFzKGNvbXBvbmVudEVsKSkge1xuICAgICAgY29uc3Qgcm1GbiA9IGVuYWJsZUhpZGVDYXJldE9uU2Nyb2xsKGNvbXBvbmVudEVsLCBpbnB1dEVsLCBzY3JvbGxFbCk7XG4gICAgICBoaWRlQ2FyZXRNYXAuc2V0KGNvbXBvbmVudEVsLCBybUZuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogZGF0ZS9kYXRldGltZS1sb2NhbGUgaW5wdXRzIG9uIG1vYmlsZSBkZXZpY2VzIHNob3cgZGF0ZSBwaWNrZXJcbiAgICAgKiBvdmVybGF5cyBpbnN0ZWFkIG9mIGtleWJvYXJkcy4gQXMgYSByZXN1bHQsIHNjcm9sbCBhc3Npc3QgaXNcbiAgICAgKiBub3QgbmVlZGVkLiBUaGlzIGFsc28gd29ya3MgYXJvdW5kIGEgYnVnIGluIGlPUyA8MTYgd2hlcmVcbiAgICAgKiBzY3JvbGwgYXNzaXN0IGNhdXNlcyB0aGUgYnJvd3NlciB0byBsb2NrIHVwLiBTZWUgRlctMTk5Ny5cbiAgICAgKi9cbiAgICBjb25zdCBpc0RhdGVJbnB1dCA9IGlucHV0RWwudHlwZSA9PT0gJ2RhdGUnIHx8IGlucHV0RWwudHlwZSA9PT0gJ2RhdGV0aW1lLWxvY2FsJztcbiAgICBpZiAoIWlzRGF0ZUlucHV0ICYmXG4gICAgICAoISFzY3JvbGxFbCB8fCAhIWZvb3RlckVsKSAmJlxuICAgICAgc2Nyb2xsQXNzaXN0ICYmXG4gICAgICAhc2Nyb2xsQXNzaXN0TWFwLmhhcyhjb21wb25lbnRFbCkpIHtcbiAgICAgIGNvbnN0IHJtRm4gPSBlbmFibGVTY3JvbGxBc3Npc3QoY29tcG9uZW50RWwsIGlucHV0RWwsIHNjcm9sbEVsLCBmb290ZXJFbCwga2V5Ym9hcmRIZWlnaHQsIGlzQW5kcm9pZCk7XG4gICAgICBzY3JvbGxBc3Npc3RNYXAuc2V0KGNvbXBvbmVudEVsLCBybUZuKTtcbiAgICB9XG4gIH07XG4gIGNvbnN0IHVucmVnaXN0ZXJJbnB1dCA9IChjb21wb25lbnRFbCkgPT4ge1xuICAgIGlmIChoaWRlQ2FyZXQpIHtcbiAgICAgIGNvbnN0IGZuID0gaGlkZUNhcmV0TWFwLmdldChjb21wb25lbnRFbCk7XG4gICAgICBpZiAoZm4pIHtcbiAgICAgICAgZm4oKTtcbiAgICAgIH1cbiAgICAgIGhpZGVDYXJldE1hcC5kZWxldGUoY29tcG9uZW50RWwpO1xuICAgIH1cbiAgICBpZiAoc2Nyb2xsQXNzaXN0KSB7XG4gICAgICBjb25zdCBmbiA9IHNjcm9sbEFzc2lzdE1hcC5nZXQoY29tcG9uZW50RWwpO1xuICAgICAgaWYgKGZuKSB7XG4gICAgICAgIGZuKCk7XG4gICAgICB9XG4gICAgICBzY3JvbGxBc3Npc3RNYXAuZGVsZXRlKGNvbXBvbmVudEVsKTtcbiAgICB9XG4gIH07XG4gIGlmIChpbnB1dEJsdXJyaW5nICYmIElOUFVUX0JMVVJSSU5HKSB7XG4gICAgZW5hYmxlSW5wdXRCbHVycmluZygpO1xuICB9XG4gIGlmIChzY3JvbGxQYWRkaW5nICYmIFNDUk9MTF9QQURESU5HKSB7XG4gICAgZW5hYmxlU2Nyb2xsUGFkZGluZyhrZXlib2FyZEhlaWdodCk7XG4gIH1cbiAgLy8gSW5wdXQgbWlnaHQgYmUgYWxyZWFkeSBsb2FkZWQgaW4gdGhlIERPTSBiZWZvcmUgaW9uLWRldmljZS1oYWNrcyBkaWQuXG4gIC8vIEF0IHRoaXMgcG9pbnQgd2UgbmVlZCB0byBsb29rIGZvciBhbGwgb2YgdGhlIGlucHV0cyBub3QgcmVnaXN0ZXJlZCB5ZXRcbiAgLy8gYW5kIHJlZ2lzdGVyIHRoZW0uXG4gIGZvciAoY29uc3QgaW5wdXQgb2YgaW5wdXRzKSB7XG4gICAgcmVnaXN0ZXJJbnB1dChpbnB1dCk7XG4gIH1cbiAgLy8gVE9ETyhGVy0yODMyKTogdHlwZXNcbiAgZG9jLmFkZEV2ZW50TGlzdGVuZXIoJ2lvbklucHV0RGlkTG9hZCcsICgoZXYpID0+IHtcbiAgICByZWdpc3RlcklucHV0KGV2LmRldGFpbCk7XG4gIH0pKTtcbiAgZG9jLmFkZEV2ZW50TGlzdGVuZXIoJ2lvbklucHV0RGlkVW5sb2FkJywgKChldikgPT4ge1xuICAgIHVucmVnaXN0ZXJJbnB1dChldi5kZXRhaWwpO1xuICB9KSk7XG59O1xuXG5leHBvcnQgeyBzdGFydElucHV0U2hpbXMgfTtcbiJdLCJuYW1lcyI6WyJjbG9uZU1hcCIsIldlYWtNYXAiLCJyZWxvY2F0ZUlucHV0IiwiY29tcG9uZW50RWwiLCJpbnB1dEVsIiwic2hvdWxkUmVsb2NhdGUiLCJpbnB1dFJlbGF0aXZlWSIsImRpc2FibGVkQ2xvbmVkSW5wdXQiLCJoYXMiLCJhZGRDbG9uZSIsInJlbW92ZUNsb25lIiwiaXNGb2N1c2VkIiwiaW5wdXQiLCJnZXRSb290Tm9kZSIsImFjdGl2ZUVsZW1lbnQiLCJwYXJlbnRFbCIsInBhcmVudE5vZGUiLCJjbG9uZWRFbCIsImNsb25lTm9kZSIsImNsYXNzTGlzdCIsImFkZCIsInRhYkluZGV4IiwiZGlzYWJsZWQiLCJhcHBlbmRDaGlsZCIsInNldCIsImRvYyIsIm93bmVyRG9jdW1lbnQiLCJ0eCIsImRpciIsInN0eWxlIiwicG9pbnRlckV2ZW50cyIsInRyYW5zZm9ybSIsImNsb25lIiwiZ2V0IiwiZGVsZXRlIiwicmVtb3ZlIiwiZW5hYmxlSGlkZUNhcmV0T25TY3JvbGwiLCJzY3JvbGxFbCIsInNjcm9sbEhpZGVDYXJldCIsInNob3VsZEhpZGVDYXJldCIsIm9uQmx1ciIsImhpZGVDYXJldCIsInNob3dDYXJldCIsImEiLCJhZGRFdmVudExpc3RlbmVyIiwiU0tJUF9TRUxFQ1RPUiIsImVuYWJsZUlucHV0Qmx1cnJpbmciLCJmb2N1c2VkIiwiZGlkU2Nyb2xsIiwiZG9jdW1lbnQiLCJvblNjcm9sbCIsIm9uRm9jdXNpbiIsIm9uVG91Y2hlbmQiLCJldiIsImFjdGl2ZSIsIm1hdGNoZXMiLCJ0YXBwZWQiLCJ0YXJnZXQiLCJjbG9zZXN0Iiwic2V0VGltZW91dCIsImJsdXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiU0NST0xMX0FTU0lTVF9TUEVFRCIsImdldFNjcm9sbERhdGEiLCJjb250ZW50RWwiLCJrZXlib2FyZEhlaWdodCIsIl9hIiwiaXRlbUVsIiwiY2FsY1Njcm9sbERhdGEiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJkZWZhdWx0VmlldyIsImlubmVySGVpZ2h0IiwiaW5wdXRSZWN0IiwiY29udGVudFJlY3QiLCJwbGF0Zm9ybUhlaWdodCIsImlucHV0VG9wIiwidG9wIiwiaW5wdXRCb3R0b20iLCJib3R0b20iLCJ2aXNpYmxlQXJlYVRvcCIsInZpc2libGVBcmVhQm90dG9tIiwiTWF0aCIsIm1pbiIsInNhZmVBcmVhVG9wIiwic2FmZUFyZWFCb3R0b20iLCJkaXN0YW5jZVRvQm90dG9tIiwiZGlzdGFuY2VUb1RvcCIsImRlc2lyZWRTY3JvbGxBbW91bnQiLCJyb3VuZCIsInNjcm9sbEFtb3VudCIsImRpc3RhbmNlIiwiYWJzIiwiZHVyYXRpb24iLCJzY3JvbGxEdXJhdGlvbiIsIm1heCIsInNjcm9sbFBhZGRpbmciLCJpbnB1dFNhZmVZIiwiZW5hYmxlU2Nyb2xsQXNzaXN0IiwiZm9vdGVyRWwiLCJkaXNhYmxlQ2xvbmVkSW5wdXQiLCJjb29yZCIsInRvdWNoU3RhcnQiLCJwIiwidG91Y2hFbmQiLCJlbmRDb29yZCIsImhhc1BvaW50ZXJNb3ZlZCIsImpzU2V0Rm9jdXMiLCJjYXB0dXJlIiwicGFzc2l2ZSIsImFzeW5jIiwic2Nyb2xsRGF0YSIsImZvY3VzIiwiciIsImNsaWNrIiwid2luZG93Iiwic2Nyb2xsQ29udGVudFRpbWVvdXQiLCJzY3JvbGxDb250ZW50IiwidW5kZWZpbmVkIiwiY2xlYXJUaW1lb3V0IiwiZG91YmxlS2V5Ym9hcmRFdmVudExpc3RlbmVyIiwiZyIsInRvdGFsU2Nyb2xsQW1vdW50Iiwic2Nyb2xsSGVpZ2h0IiwiY2xpZW50SGVpZ2h0Iiwic2Nyb2xsVG9wIiwidHlwZSIsInRocmVzaG9sZCIsInN0YXJ0Q29vcmQiLCJkZWx0YVgiLCJ4IiwiZGVsdGFZIiwieSIsIlBBRERJTkdfVElNRVJfS0VZIiwiZW5hYmxlU2Nyb2xsUGFkZGluZyIsInNldFNjcm9sbFBhZGRpbmciLCJvbkZvY3Vzb3V0IiwiX2IiLCJ0YWdOYW1lIiwicGFyZW50RWxlbWVudCIsImVsIiwidGltZXIiLCJzZXRQcm9wZXJ0eSIsIklOUFVUX0JMVVJSSU5HIiwiU0NST0xMX1BBRERJTkciLCJzdGFydElucHV0U2hpbXMiLCJjb25maWciLCJwbGF0Zm9ybSIsImlzSU9TIiwiaXNBbmRyb2lkIiwiZ2V0TnVtYmVyIiwic2Nyb2xsQXNzaXN0IiwiZ2V0Qm9vbGVhbiIsImlucHV0Qmx1cnJpbmciLCJpbnB1dHMiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiaGlkZUNhcmV0TWFwIiwic2Nyb2xsQXNzaXN0TWFwIiwicmVnaXN0ZXJJbnB1dCIsIlByb21pc2UiLCJyZXNvbHZlIiwiYyIsImlucHV0Um9vdCIsInNoYWRvd1Jvb3QiLCJxdWVyeVNlbGVjdG9yIiwicm1GbiIsImlzRGF0ZUlucHV0IiwidW5yZWdpc3RlcklucHV0IiwiZm4iLCJkZXRhaWwiXSwic291cmNlUm9vdCI6IiJ9